<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤±çœ åš´é‡åº¦é‡è¡¨ (ISI) - è›¹ä¹‹ç”Ÿå¿ƒç†å¥åº·é›†åœ˜</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4a90e2 0%, #357abd 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .form-container {
            padding: 40px;
        }
        
        .question {
            margin-bottom: 35px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 5px solid #4a90e2;
        }
        
        .question h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            font-size: 18px;
            line-height: 1.5;
        }
        
        .sub-question {
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        
        .sub-question h4 {
            margin-bottom: 15px;
            color: #495057;
            font-size: 16px;
        }
        
        .options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 8px;
        }
        
        .option {
            position: relative;
        }
        
        .option input[type="radio"] {
            position: absolute;
            opacity: 0;
        }
        
        .option label {
            display: block;
            padding: 8px 4px;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
            color: #495057;
            line-height: 1.2;
            min-height: 45px;
        }
        
        .option input[type="radio"]:checked + label {
            background: #4a90e2;
            color: white;
            border-color: #4a90e2;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
        }
        
        .option label:hover {
            border-color: #4a90e2;
            transform: translateY(-1px);
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 30px auto 0;
            min-width: 200px;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(40, 167, 69, 0.3);
        }
        
        .submit-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .result {
            display: none;
            margin-top: 30px;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 10px;
            text-align: center;
        }
        
        .score {
            font-size: 48px;
            font-weight: bold;
            color: #4a90e2;
            margin-bottom: 15px;
        }
        
        .level {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .description {
            font-size: 16px;
            line-height: 1.6;
            color: #495057;
            margin-bottom: 20px;
        }
        
        .recommendation {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .recommendation h4 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .recommendation p {
            color: #856404;
            line-height: 1.5;
        }
        
        .contact-info {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .contact-info h4 {
            color: #0056b3;
            margin-bottom: 10px;
        }
        
        .contact-info p {
            color: #0056b3;
            line-height: 1.5;
        }
        
        .reset-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
        }
        
        .reset-btn:hover {
            background: #5a6268;
        }
        
        /* å°å‹è£ç½® (æ‰‹æ©Ÿ) */
        @media (max-width: 576px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .header {
                padding: 20px 15px;
            }
            
            .header h1 {
                font-size: 22px;
            }
            
            .header p {
                font-size: 14px;
            }
            
            .form-container {
                padding: 15px;
            }
            
            .question {
                padding: 15px;
                margin-bottom: 20px;
            }
            
            .question h3 {
                font-size: 16px;
            }
            
            .sub-question {
                padding: 10px;
            }
            
            .sub-question h4 {
                font-size: 14px;
            }
            
            .options {
                grid-template-columns: repeat(2, 1fr);
                gap: 6px;
            }
            
            /* åŸºæœ¬è³‡æ–™å€å¡Šçš„ç‰¹æ®Šè™•ç† */
            .question:first-of-type .options {
                grid-template-columns: 1fr;
            }
            
            .option label {
                padding: 6px 2px;
                font-size: 11px;
                min-height: 40px;
            }
            
            .submit-btn {
                font-size: 16px;
                padding: 12px 30px;
                min-width: 180px;
            }
            
            .score {
                font-size: 32px;
            }
            
            .level {
                font-size: 18px;
            }
            
            .description {
                font-size: 14px;
            }
            
            .recommendation, .contact-info {
                padding: 15px;
            }
        }
        
        /* ä¸­å‹è£ç½® (å¹³æ¿) */
        @media (min-width: 577px) and (max-width: 768px) {
            .form-container {
                padding: 25px;
            }
            
            .options {
                grid-template-columns: repeat(3, 1fr);
                gap: 8px;
            }
            
            .option label {
                padding: 10px 6px;
                font-size: 12px;
                min-height: 50px;
            }
            
            .header h1 {
                font-size: 26px;
            }
            
            .score {
                font-size: 42px;
            }
            
            .level {
                font-size: 22px;
            }
        }
        
        /* å¤§å‹è£ç½® (æ¡Œé¢) */
        @media (min-width: 769px) and (max-width: 1024px) {
            .options {
                grid-template-columns: repeat(5, 1fr);
                gap: 10px;
            }
            
            .option label {
                padding: 10px 6px;
                font-size: 13px;
                min-height: 50px;
            }
        }
        
        /* è¶…å¤§å‹è£ç½® */
        @media (min-width: 1025px) {
            .container {
                max-width: 900px;
            }
            
            .options {
                grid-template-columns: repeat(5, 1fr);
                gap: 12px;
            }
            
            .option label {
                padding: 12px 8px;
                font-size: 13px;
                min-height: 55px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>å¤±çœ åš´é‡åº¦é‡è¡¨</h1>
            <p>Insomnia Severity Index (ISI)</p>
            <p style="margin-top: 10px; font-size: 14px;">è›¹ä¹‹ç”Ÿå¿ƒç†å¥åº·é›†åœ˜</p>
            <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 8px; font-size: 14px;">
                <p>ğŸ”’ <strong>åŒ¿åå¡«ç­”ä¿è­‰</strong></p>
                <p style="margin-top: 5px;">æ­¤å•å·æ¡å®Œå…¨åŒ¿åæ–¹å¼ï¼Œä¸æœƒæ”¶é›†ä»»ä½•å€‹äººè­˜åˆ¥è³‡è¨Šã€‚<br>
                æ‰€æœ‰æ•¸æ“šåƒ…ä¾›å¤§æ•¸æ“šåˆ†æä½¿ç”¨ï¼Œè«‹å®‰å¿ƒå¡«ç­”ã€‚</p>
            </div>
        </div>
        
        <div class="form-container">
            <form id="isiForm">
                <!-- åŸºæœ¬è³‡æ–™å€å¡Š -->
                <div class="question">
                    <h3>ğŸ“‹ åŸºæœ¬è³‡æ–™</h3>
                    
                    <div class="sub-question">
                        <h4>å¹´é½¡</h4>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="age" value="18-25" id="age_1">
                                <label for="age_1">18-25æ­²</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="age" value="26-35" id="age_2">
                                <label for="age_2">26-35æ­²</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="age" value="36-45" id="age_3">
                                <label for="age_3">36-45æ­²</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="age" value="46-55" id="age_4">
                                <label for="age_4">46-55æ­²</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="age" value="56+" id="age_5">
                                <label for="age_5">56æ­²ä»¥ä¸Š</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="sub-question">
                        <h4>æ€§åˆ¥</h4>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="gender" value="male" id="gender_1">
                                <label for="gender_1">ç”·æ€§</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="gender" value="female" id="gender_2">
                                <label for="gender_2">å¥³æ€§</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="gender" value="other" id="gender_3">
                                <label for="gender_3">å…¶ä»–</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="gender" value="prefer_not_to_say" id="gender_4">
                                <label for="gender_4">ä¸ä¾¿é€éœ²</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="sub-question">
                        <h4>å·¥ä½œå¹´è³‡</h4>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="experience" value="0-1" id="exp_1">
                                <label for="exp_1">1å¹´ä»¥ä¸‹</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="experience" value="1-3" id="exp_2">
                                <label for="exp_2">1-3å¹´</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="experience" value="3-5" id="exp_3">
                                <label for="exp_3">3-5å¹´</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="experience" value="5-10" id="exp_4">
                                <label for="exp_4">5-10å¹´</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="experience" value="10+" id="exp_5">
                                <label for="exp_5">10å¹´ä»¥ä¸Š</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="question">
                    <h3>ğŸŒ™ 1. è©•ä¼°é€™å…©é€±å…§å¤±çœ å•é¡Œçš„åš´é‡ç¨‹åº¦</h3>
                    
                    <div class="sub-question">
                        <h4>a. å…¥ç¡å›°é›£</h4>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q1a" value="0" id="q1a_0">
                                <label for="q1a_0">ç„¡<br>(0)</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q1a" value="1" id="q1a_1">
                                <label for="q1a_1">è¼•åº¦<br>(1)</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q1a" value="2" id="q1a_2">
                                <label for="q1a_2">ä¸­åº¦<br>(2)</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q1a" value="3" id="q1a_3">
                                <label for="q1a_3">é‡åº¦<br>(3)</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q1a" value="4" id="q1a_4">
                                <label for="q1a_4">éå¸¸åš´é‡<br>(4)</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="sub-question">
                        <h4>b. ç„¡æ³•ç¶­æŒè¼ƒé•·çš„ç¡çœ </h4>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q1b" value="0" id="q1b_0">
                                <label for="q1b_0">ç„¡<br>(0)</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q1b" value="1" id="q1b_1">
                                <label for="q1b_1">è¼•åº¦<br>(1)</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q1b" value="2" id="q1b_2">
                                <label for="q1b_2">ä¸­åº¦<br>(2)</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q1b" value="3" id="q1b_3">
                                <label for="q1b_3">é‡åº¦<br>(3)</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q1b" value="4" id="q1b_4">
                                <label for="q1b_4">éå¸¸åš´é‡<br>(4)</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="sub-question">
                        <h4>c. å¤ªæ—©é†’</h4>
                        <div class="options">
                            <div class="option">
                                <input type="radio" name="q1c" value="0" id="q1c_0">
                                <label for="q1c_0">ç„¡<br>(0)</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q1c" value="1" id="q1c_1">
                                <label for="q1c_1">è¼•åº¦<br>(1)</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q1c" value="2" id="q1c_2">
                                <label for="q1c_2">ä¸­åº¦<br>(2)</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q1c" value="3" id="q1c_3">
                                <label for="q1c_3">é‡åº¦<br>(3)</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q1c" value="4" id="q1c_4">
                                <label for="q1c_4">éå¸¸åš´é‡<br>(4)</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="question">
                    <h3>ğŸŒ™ 2. æ‚¨æ»¿æ„è‡ªå·±æœ€è¿‘çš„ç¡çœ ç‹€æ…‹å—ï¼Ÿ</h3>
                    <div class="options">
                        <div class="option">
                            <input type="radio" name="q2" value="0" id="q2_0">
                            <label for="q2_0">éå¸¸æ»¿æ„<br>(0)</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q2" value="1" id="q2_1">
                            <label for="q2_1">æ»¿æ„<br>(1)</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q2" value="2" id="q2_2">
                            <label for="q2_2">ä¸­ç­‰<br>(2)</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q2" value="3" id="q2_3">
                            <label for="q2_3">ä¸æ»¿æ„<br>(3)</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q2" value="4" id="q2_4">
                            <label for="q2_4">éå¸¸ä¸æ»¿æ„<br>(4)</label>
                        </div>
                    </div>
                </div>
                
                <div class="question">
                    <h3>ğŸŒ™ 3. ç¡çœ å•é¡Œæ˜¯å¦æœ‰å¹²æ“¾åˆ°æ‚¨çš„æ—¥å¸¸ç”Ÿæ´»åŠŸèƒ½ï¼Ÿ</h3>
                    <div class="options">
                        <div class="option">
                            <input type="radio" name="q3" value="0" id="q3_0">
                            <label for="q3_0">å®Œå…¨ç„¡å¹²æ“¾<br>(0)</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q3" value="1" id="q3_1">
                            <label for="q3_1">ä¸€é»<br>(1)</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q3" value="2" id="q3_2">
                            <label for="q3_2">ç¨å¾®<br>(2)</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q3" value="3" id="q3_3">
                            <label for="q3_3">å¾ˆå¤š<br>(3)</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q3" value="4" id="q3_4">
                            <label for="q3_4">éå¸¸å¤š<br>(4)</label>
                        </div>
                    </div>
                </div>
                
                <div class="question">
                    <h3>ğŸŒ™ 4. ä»–äººæ˜¯å¦æœ‰æ³¨æ„åˆ°æ‚¨çš„ç”Ÿæ´»å“è³ªå› ç¡çœ å•é¡Œå—åˆ°å½±éŸ¿ï¼Ÿ</h3>
                    <div class="options">
                        <div class="option">
                            <input type="radio" name="q4" value="0" id="q4_0">
                            <label for="q4_0">å®Œå…¨æ²’æ³¨æ„<br>(0)</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q4" value="1" id="q4_1">
                            <label for="q4_1">ä¸€é»<br>(1)</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q4" value="2" id="q4_2">
                            <label for="q4_2">ç¨å¾®<br>(2)</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q4" value="3" id="q4_3">
                            <label for="q4_3">å¾ˆå¤š<br>(3)</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q4" value="4" id="q4_4">
                            <label for="q4_4">éå¸¸æ³¨æ„<br>(4)</label>
                        </div>
                    </div>
                </div>
                
                <div class="question">
                    <h3>ğŸŒ™ 5. æœ€è¿‘çš„ç¡çœ å•é¡Œæ˜¯å¦ä»¤æ‚¨æ“”å¿ƒ/å›°æ“¾ï¼Ÿ</h3>
                    <div class="options">
                        <div class="option">
                            <input type="radio" name="q5" value="0" id="q5_0">
                            <label for="q5_0">å®Œå…¨æ²’æ³¨æ„<br>(0)</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q5" value="1" id="q5_1">
                            <label for="q5_1">ä¸€é»<br>(1)</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q5" value="2" id="q5_2">
                            <label for="q5_2">ç¨å¾®<br>(2)</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q5" value="3" id="q5_3">
                            <label for="q5_3">å¾ˆå¤š<br>(3)</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q5" value="4" id="q5_4">
                            <label for="q5_4">éå¸¸æ“”å¿ƒ<br>(4)</label>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="submit-btn" id="submitBtn">è¨ˆç®—çµæœ</button>
            </form>
            
            <div class="result" id="result">
                <div class="score" id="scoreDisplay"></div>
                <div class="level" id="levelDisplay"></div>
                <div class="description" id="descriptionDisplay"></div>
                <div class="recommendation" id="recommendationDisplay"></div>
                <div class="contact-info">
                    <h4>ğŸ¥ è›¹ä¹‹ç”Ÿå¿ƒç†å¥åº·é›†åœ˜</h4>
                    <p>å¦‚éœ€å°ˆæ¥­å”åŠ©ï¼Œæ­¡è¿è¯ç¹«æˆ‘å€‘çš„æ“šé»ï¼š</p>
                    <p>å°åŒ—æ˜å¾·é¤¨ | å°åŒ—å—æ¸¯é¤¨ | æ–°åŒ—æ¿æ©‹é¤¨ | æ–°åŒ—ä¸­å’Œé¤¨<br>
                    æ–°ç«¹å…‰å¾©é¤¨ | å°ä¸­äº”æ¬Šé¤¨ | å°ä¸­æ–‡å¿ƒé¤¨ | é«˜é›„æ¥ æ¢“é¤¨</p>
                </div>
                <button type="button" class="reset-btn" onclick="resetForm()">é‡æ–°æ¸¬é©—</button>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('isiForm').addEventListener('submit', function(e) {
            e.preventDefault();
            calculateResult();
        });

        function calculateResult() {
            const formData = new FormData(document.getElementById('isiForm'));
            
            // æª¢æŸ¥æ˜¯å¦æ‰€æœ‰é¡Œç›®éƒ½å·²å›ç­”
            const requiredQuestions = ['age', 'gender', 'experience', 'q1a', 'q1b', 'q1c', 'q2', 'q3', 'q4', 'q5'];
            for (let question of requiredQuestions) {
                if (!formData.get(question)) {
                    alert('è«‹å®Œæˆæ‰€æœ‰é¡Œç›®å¾Œå†æäº¤');
                    return;
                }
            }
            
            // è¨ˆç®—ç¸½åˆ†
            let totalScore = 0;
            totalScore += parseInt(formData.get('q1a'));
            totalScore += parseInt(formData.get('q1b'));
            totalScore += parseInt(formData.get('q1c'));
            totalScore += parseInt(formData.get('q2'));
            totalScore += parseInt(formData.get('q3'));
            totalScore += parseInt(formData.get('q4'));
            totalScore += parseInt(formData.get('q5'));
            
            // é¡¯ç¤ºçµæœ
            displayResult(totalScore);
            
            // æ”¶é›†æ•¸æ“šï¼ˆå¯é¸ï¼‰
            collectData({
                score: totalScore,
                demographics: {
                    age: formData.get('age'),
                    gender: formData.get('gender'),
                    experience: formData.get('experience')
                },
                answers: {
                    q1a: formData.get('q1a'),
                    q1b: formData.get('q1b'),
                    q1c: formData.get('q1c'),
                    q2: formData.get('q2'),
                    q3: formData.get('q3'),
                    q4: formData.get('q4'),
                    q5: formData.get('q5')
                },
                timestamp: new Date().toISOString()
            });
        }

        function displayResult(score) {
            let level, description, recommendation;
            let levelColor = '#4a90e2';
            
            if (score <= 7) {
                level = 'ç„¡æ˜é¡¯å¤±çœ å›°æ“¾';
                description = 'æ‚¨çš„ç¡çœ ç‹€æ³è‰¯å¥½ï¼Œæ²’æœ‰æ˜é¡¯çš„å¤±çœ å•é¡Œã€‚';
                recommendation = 'å»ºè­°ç¶­æŒè‰¯å¥½çš„ç¡çœ ç¿’æ…£ï¼Œä¿æŒè¦å¾‹çš„ä½œæ¯æ™‚é–“ã€‚';
                levelColor = '#28a745';
            } else if (score <= 14) {
                level = 'ç¨æœ‰ç¡çœ å›°æ“¾';
                description = 'æ‚¨æœ‰è¼•å¾®çš„ç¡çœ å›°æ“¾ï¼Œä½†é‚„ä¸ç®—åš´é‡ã€‚';
                recommendation = 'å»ºè­°æ”¹å–„ç¡çœ ç’°å¢ƒï¼Œé¿å…ç¡å‰ä½¿ç”¨é›»å­ç”¢å“ï¼Œå»ºç«‹è‰¯å¥½çš„ç¡å‰å„€å¼ã€‚';
                levelColor = '#ffc107';
            } else if (score <= 21) {
                level = 'æœ‰æ˜é¡¯å¤±çœ å›°æ“¾';
                description = 'æ‚¨æœ‰æ˜é¡¯çš„å¤±çœ å•é¡Œï¼Œå·²å½±éŸ¿åˆ°æ—¥å¸¸ç”Ÿæ´»ã€‚';
                recommendation = 'å»ºè­°å°‹æ±‚å°ˆæ¥­é†«ç™‚å”åŠ©ï¼Œé€²è¡Œé€²ä¸€æ­¥çš„è©•ä¼°å’Œæ²»ç™‚ã€‚è›¹ä¹‹ç”Ÿå¿ƒç†å¥åº·é›†åœ˜å¯ä»¥ç‚ºæ‚¨æä¾›å°ˆæ¥­çš„å”åŠ©ã€‚';
                levelColor = '#fd7e14';
            } else {
                level = 'æœ‰åš´é‡å¤±çœ å›°æ“¾';
                description = 'æ‚¨æœ‰åš´é‡çš„å¤±çœ å•é¡Œï¼Œåš´é‡å½±éŸ¿ç”Ÿæ´»å“è³ªã€‚';
                recommendation = 'å¼·çƒˆå»ºè­°ç«‹å³å°‹æ±‚å°ˆæ¥­é†«ç™‚å”åŠ©ã€‚è›¹ä¹‹ç”Ÿå¿ƒç†å¥åº·é›†åœ˜çš„å°ˆæ¥­åœ˜éšŠå¯ä»¥ç‚ºæ‚¨æä¾›å®Œæ•´çš„æ²»ç™‚æ–¹æ¡ˆã€‚';
                levelColor = '#dc3545';
            }
            
            document.getElementById('scoreDisplay').textContent = score + ' åˆ†';
            document.getElementById('levelDisplay').textContent = level;
            document.getElementById('levelDisplay').style.color = levelColor;
            document.getElementById('descriptionDisplay').textContent = description;
            document.getElementById('recommendationDisplay').innerHTML = 
                '<h4>ğŸ’¡ å»ºè­°</h4><p>' + recommendation + '</p>';
            
            // éš±è—è¡¨å–®ï¼Œé¡¯ç¤ºçµæœ
            document.getElementById('isiForm').style.display = 'none';
            document.getElementById('result').style.display = 'block';
            
            // æ»¾å‹•åˆ°çµæœå€åŸŸ
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
        }

        function resetForm() {
            document.getElementById('isiForm').reset();
            document.getElementById('isiForm').style.display = 'block';
            document.getElementById('result').style.display = 'none';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function collectData(data) {
            // ç™¼é€æ•¸æ“šåˆ° Google Sheets
            const GOOGLE_SCRIPT_URL = 'https://script.google.com/a/macros/morph.tw/s/AKfycbzx_ZSETv39c5XVog1Fv7nBAS_qbwJ7Gup98sOOS97JmdSJIEveDE-G8u32REHWOPmF/exec';
            
            try {
                // åŒæ™‚ä¿å­˜åˆ°æœ¬åœ°å’Œ Google Sheets
                let existingData = JSON.parse(localStorage.getItem('isiResults') || '[]');
                existingData.push(data);
                localStorage.setItem('isiResults', JSON.stringify(existingData));
                
                // ç™¼é€åˆ° Google Sheets
                fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data),
                    mode: 'no-cors'
                })
                .then(() => {
                    console.log('æ•¸æ“šå·²æˆåŠŸç™¼é€åˆ° Google Sheets');
                })
                .catch(error => {
                    console.error('ç¶²è·¯éŒ¯èª¤:', error);
                    // å³ä½¿ç™¼é€å¤±æ•—ï¼Œæœ¬åœ°æ•¸æ“šå·²ä¿å­˜
                });
                
                console.log('æ•¸æ“šå·²ä¿å­˜:', data);
            } catch (error) {
                console.log('æ•¸æ“šä¿å­˜å¤±æ•—:', error);
            }
        }
        
        // å¯é¸ï¼šæŸ¥çœ‹æ”¶é›†çš„æ•¸æ“š
        function viewCollectedData() {
            try {
                const data = JSON.parse(localStorage.getItem('isiResults') || '[]');
                console.log('æ”¶é›†çš„æ•¸æ“š:', data);
                return data;
            } catch (error) {
                console.log('è®€å–æ•¸æ“šå¤±æ•—:', error);
                return [];
            }
        }
    </script>
</body>
</html>